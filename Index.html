<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kiramel Studios Hub</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', 'Helvetica Neue', sans-serif;
            background: #0a0a0a;
            color: #ffffff;
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* ===== GLOBAL STYLES ===== */
        .page {
            display: none;
            min-height: 100vh;
            position: relative;
        }

        .page.active {
            display: flex;
        }

        .container {
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* ===== THRESHOLD PAGE ===== */
        #threshold {
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a0f0f 100%);
        }

        .threshold-content {
            text-align: center;
            z-index: 2;
        }

        .threshold-prompt {
            font-size: 2.5rem;
            font-weight: 300;
            letter-spacing: 0.15em;
            margin-bottom: 4rem;
            opacity: 0;
            animation: fadeInDown 1.5s ease-out forwards;
        }

        .logo-container {
            width: 200px;
            height: 200px;
            margin: 0 auto 4rem;
            position: relative;
            opacity: 0;
            animation: fadeInUp 2s ease-out 0.3s forwards;
        }

        .logo {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        /* 3D Caramel Logo Animation */
        .caramel {
            width: 160px;
            height: 160px;
            background: radial-gradient(circle at 30% 30%, #f4d4a8, #c9a460, #8b6914);
            border-radius: 50% 50% 60% 40%;
            position: relative;
            box-shadow: inset -10px -10px 30px rgba(0,0,0,0.4), 0 20px 60px rgba(0,0,0,0.6);
            animation: bobbing 3s ease-in-out infinite;
            transform-style: preserve-3d;
            perspective: 1000px;
        }

        .caramel::before {
            content: '';
            position: absolute;
            top: -30px;
            left: 40px;
            width: 0;
            height: 0;
            border-left: 20px solid transparent;
            border-right: 0px solid transparent;
            border-bottom: 50px solid rgba(255, 100, 180, 0.8);
            opacity: 0.7;
            filter: blur(2px);
            animation: liquidFlow 4s ease-in-out infinite;
        }

        .caramel::after {
            content: '';
            position: absolute;
            top: -25px;
            left: 60px;
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 0px solid transparent;
            border-bottom: 40px solid rgba(100, 200, 255, 0.6);
            opacity: 0.6;
            filter: blur(1px);
            animation: liquidFlow 5s ease-in-out infinite 0.5s;
        }

        .bite {
            position: absolute;
            top: 20px;
            right: -10px;
            width: 60px;
            height: 60px;
            background: #0a0a0a;
            border-radius: 50%;
            box-shadow: inset 5px 5px 15px rgba(0,0,0,0.8);
        }

        @keyframes bobbing {
            0%, 100% { transform: translateY(0) rotateX(0deg) rotateZ(-5deg); }
            50% { transform: translateY(-20px) rotateX(2deg) rotateZ(5deg); }
        }

        @keyframes liquidFlow {
            0%, 100% { transform: translateY(0) rotateZ(0deg); }
            25% { transform: translateY(10px) rotateZ(5deg); }
            50% { transform: translateY(20px) rotateZ(-3deg); }
            75% { transform: translateY(10px) rotateZ(4deg); }
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .enter-button {
            margin-top: 3rem;
            padding: 1rem 2.5rem;
            font-size: 1rem;
            letter-spacing: 0.1em;
            background: transparent;
            border: 2px solid #ffffff;
            color: #ffffff;
            cursor: pointer;
            transition: all 0.3s ease;
            opacity: 0;
            animation: fadeInUp 2s ease-out 0.6s forwards;
            text-transform: uppercase;
        }

        .enter-button:hover {
            background: #ffffff;
            color: #0a0a0a;
            box-shadow: 0 0 20px rgba(255,255,255,0.3);
        }

        /* ===== TRAILER PAGE ===== */
        #trailer {
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: #000000;
            position: relative;
        }

        .trailer-container {
            width: 100%;
            max-width: 900px;
            position: relative;
        }

        .video-wrapper {
            position: relative;
            width: 100%;
            padding-bottom: 56.25%;
            background: #000;
            border: 1px solid #333;
            overflow: hidden;
        }

        .video-wrapper iframe,
        .video-wrapper video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .trailer-info {
            text-align: center;
            margin-top: 2rem;
            padding: 2rem;
            border-top: 1px solid #333;
        }

        .trailer-title {
            font-size: 1.5rem;
            font-weight: 300;
            letter-spacing: 0.1em;
            margin-bottom: 1rem;
        }

        .trailer-description {
            font-size: 0.95rem;
            color: #cccccc;
            margin-bottom: 1rem;
        }

        .progress-bar {
            height: 2px;
            background: #333;
            margin-top: 2rem;
            width: 100%;
            border-radius: 2px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff6cb4, #64c8ff);
            width: 0%;
            transition: width 0.1s linear;
        }

        .timer {
            font-size: 0.85rem;
            color: #999;
            margin-top: 1rem;
        }

        /* ===== HUB PAGE ===== */
        #hub {
            flex-direction: column;
            background: linear-gradient(135deg, #0a0a0a 0%, #0f0a10 100%);
            padding-bottom: 4rem;
        }

        .hub-header {
            text-align: center;
            padding: 3rem 0 2rem;
            border-bottom: 1px solid #333;
        }

        .hub-title {
            font-size: 2rem;
            font-weight: 300;
            letter-spacing: 0.15em;
            margin-bottom: 0.5rem;
        }

        .era-info {
            font-size: 0.9rem;
            color: #999;
            letter-spacing: 0.08em;
        }

        .content-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }

        .content-card {
            background: rgba(255,255,255,0.02);
            border: 1px solid #333;
            padding: 2rem;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .content-card:hover {
            background: rgba(255,255,255,0.05);
            border-color: #666;
            transform: translateY(-5px);
        }

        .content-card h3 {
            font-size: 1.2rem;
            font-weight: 300;
            letter-spacing: 0.1em;
            margin-bottom: 1rem;
            text-transform: uppercase;
        }

        .content-card p {
            color: #aaa;
            font-size: 0.9rem;
            line-height: 1.6;
        }

        .section-title {
            font-size: 1.4rem;
            font-weight: 300;
            letter-spacing: 0.1em;
            margin-top: 3rem;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #333;
            text-transform: uppercase;
        }

        .worlds-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .world-card {
            position: relative;
            height: 300px;
            overflow: hidden;
            border: 1px solid #333;
            cursor: pointer;
            transition: all 0.3s ease;
            background: linear-gradient(135deg, rgba(100,100,100,0.1), rgba(50,50,50,0.1));
        }

        .world-card:hover {
            transform: scale(1.02);
            box-shadow: 0 0 20px rgba(255,255,255,0.1);
        }

        .world-card-content {
            position: absolute;
            inset: 0;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            padding: 2rem;
            background: linear-gradient(180deg, transparent 0%, rgba(0,0,0,0.8) 100%);
        }

        .world-card h3 {
            font-size: 1.3rem;
            font-weight: 300;
            letter-spacing: 0.1em;
            margin-bottom: 0.5rem;
        }

        .world-card-year {
            font-size: 0.9rem;
            color: #999;
        }

        .locked-indicator {
            display: inline-block;
            padding: 0.5rem 1rem;
            background: rgba(255,255,255,0.1);
            border: 1px solid #666;
            border-radius: 2px;
            font-size: 0.8rem;
            letter-spacing: 0.08em;
            margin-top: 0.5rem;
        }

        /* ===== WORLD PAGE ===== */
        #world {
            flex-direction: column;
            background: linear-gradient(135deg, #0a0a0a 0%, #0f0a10 100%);
        }

        .world-header {
            padding: 3rem 0;
            border-bottom: 1px solid #333;
        }

        .world-title {
            font-size: 2rem;
            font-weight: 300;
            letter-spacing: 0.15em;
            margin-bottom: 0.5rem;
        }

        .world-year {
            font-size: 1rem;
            color: #999;
        }

        .world-description {
            color: #aaa;
            margin-top: 1rem;
            max-width: 600px;
            line-height: 1.8;
        }

        .songs-section,
        .films-section {
            margin-top: 3rem;
        }

        .song-list {
            display: grid;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .song-item {
            padding: 1.5rem;
            background: rgba(255,255,255,0.01);
            border: 1px solid #333;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .song-item:hover {
            background: rgba(255,255,255,0.05);
            border-color: #555;
        }

        .song-info h4 {
            font-size: 1rem;
            font-weight: 400;
            margin-bottom: 0.3rem;
        }

        .song-duration {
            font-size: 0.85rem;
            color: #999;
        }

        .play-icon {
            font-size: 1.5rem;
            opacity: 0.5;
            transition: opacity 0.3s ease;
        }

        .song-item:hover .play-icon {
            opacity: 1;
        }

        /* ===== LORE PACK PAGE ===== */
        #lore-pack {
            flex-direction: column;
            background: linear-gradient(135deg, #0a0a0a 0%, #0f0a10 100%);
        }

        .lore-header {
            padding: 3rem 0;
            border-bottom: 1px solid #333;
        }

        .lore-title {
            font-size: 2rem;
            font-weight: 300;
            letter-spacing: 0.15em;
            margin-bottom: 0.5rem;
        }

        .lore-subtitle {
            color: #999;
            font-size: 0.95rem;
        }

        .lore-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .lore-card {
            background: rgba(255,255,255,0.02);
            border: 1px solid #333;
            padding: 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .lore-card:hover {
            background: rgba(255,255,255,0.05);
            border-color: #666;
            transform: translateY(-5px);
        }

        .lore-card h3 {
            font-size: 1rem;
            font-weight: 400;
            letter-spacing: 0.08em;
            margin-bottom: 1rem;
            text-transform: uppercase;
        }

        .lore-card p {
            color: #aaa;
            font-size: 0.9rem;
            line-height: 1.6;
        }

        /* ===== COMMUNITY PAGE ===== */
        #community {
            flex-direction: column;
            background: linear-gradient(135deg, #0a0a0a 0%, #0f0a10 100%);
        }

        .community-header {
            padding: 3rem 0;
            border-bottom: 1px solid #333;
        }

        .community-title {
            font-size: 2rem;
            font-weight: 300;
            letter-spacing: 0.15em;
            margin-bottom: 1rem;
        }

        .community-notice {
            background: rgba(255,255,255,0.02);
            border-left: 2px solid #666;
            padding: 1.5rem;
            color: #aaa;
            font-size: 0.95rem;
            margin-bottom: 2rem;
        }

        .community-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .community-thread {
            background: rgba(255,255,255,0.02);
            border: 1px solid #333;
            padding: 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .community-thread:hover {
            background: rgba(255,255,255,0.05);
            border-color: #666;
        }

        .thread-title {
            font-size: 1.1rem;
            font-weight: 400;
            margin-bottom: 0.5rem;
        }

        .thread-meta {
            color: #999;
            font-size: 0.85rem;
        }

        /* ===== WRITERS' ROOM PAGE ===== */
        #writers-room {
            flex-direction: column;
            background: linear-gradient(135deg, #0a0a0a 0%, #0f0a10 100%);
        }

        .writers-header {
            padding: 3rem 0;
            border-bottom: 1px solid #333;
        }

        .writers-title {
            font-size: 2rem;
            font-weight: 300;
            letter-spacing: 0.15em;
            margin-bottom: 1rem;
        }

        .submission-notice {
            background: rgba(255,255,255,0.02);
            border-left: 2px solid #666;
            padding: 1.5rem;
            color: #aaa;
            font-size: 0.95rem;
            margin-bottom: 2rem;
        }

        .submission-categories {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .category-card {
            background: rgba(255,255,255,0.02);
            border: 1px solid #333;
            padding: 2rem;
        }

        .category-title {
            font-size: 1.1rem;
            font-weight: 400;
            letter-spacing: 0.08em;
            margin-bottom: 1rem;
            text-transform: uppercase;
        }

        .category-description {
            color: #aaa;
            font-size: 0.9rem;
            line-height: 1.6;
            margin-bottom: 1.5rem;
        }

        .submit-button {
            width: 100%;
            padding: 0.8rem;
            background: transparent;
            border: 1px solid #666;
            color: #fff;
            cursor: pointer;
            transition: all 0.3s ease;
            letter-spacing: 0.08em;
        }

        .submit-button:hover {
            background: rgba(255,255,255,0.1);
            border-color: #fff;
        }

        /* ===== NAVIGATION ===== */
        .navigation {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(10,10,10,0.95);
            border-bottom: 1px solid #333;
            padding: 1rem 2rem;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        .navigation.active {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-logo {
            font-size: 1rem;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            font-weight: 300;
        }

        .nav-menu {
            display: flex;
            gap: 2rem;
            list-style: none;
        }

        .nav-menu button {
            background: none;
            border: none;
            color: #fff;
            cursor: pointer;
            font-size: 0.9rem;
            letter-spacing: 0.08em;
            text-transform: uppercase;
            transition: all 0.3s ease;
            padding: 0.5rem 0;
            border-bottom: 2px solid transparent;
        }

        .nav-menu button:hover,
        .nav-menu button.active {
            color: #aaa;
            border-bottom-color: #666;
        }

        .nav-menu button.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Adjust main content when nav is visible */
        body.has-nav #hub,
        body.has-nav #world,
        body.has-nav #lore-pack,
        body.has-nav #community,
        body.has-nav #writers-room {
            margin-top: 70px;
        }

        /* ===== MODAL ===== */
        .modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.9);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 2rem;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: #1a1a1a;
            border: 1px solid #333;
            padding: 3rem;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            animation: slideUp 0.3s ease;
        }

        .modal-close {
            position: absolute;
            top: 2rem;
            right: 2rem;
            background: none;
            border: none;
            color: #fff;
            font-size: 2rem;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 300;
            letter-spacing: 0.1em;
            margin-bottom: 2rem;
        }

        .modal-text {
            color: #aaa;
            line-height: 1.8;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ===== UTILITY BUTTON ===== */
        .btn {
            padding: 0.8rem 1.5rem;
            background: transparent;
            border: 1px solid #fff;
            color: #fff;
            cursor: pointer;
            transition: all 0.3s ease;
            letter-spacing: 0.08em;
            text-transform: uppercase;
        }

        .btn:hover {
            background: #fff;
            color: #0a0a0a;
        }

        .btn.secondary {
            border-color: #666;
            color: #aaa;
        }

        .btn.secondary:hover {
            border-color: #fff;
            color: #fff;
            background: rgba(255,255,255,0.05);
        }

        /* ===== BACK NAVIGATION ===== */
        .back-nav {
            padding: 1rem 0;
            margin-bottom: 2rem;
            border-bottom: 1px solid #333;
        }

        .back-button {
            background: none;
            border: none;
            color: #999;
            cursor: pointer;
            font-size: 0.9rem;
            letter-spacing: 0.08em;
            transition: color 0.3s ease;
        }

        .back-button:hover {
            color: #fff;
        }

        /* ===== RESPONSIVE ===== */
        @media (max-width: 768px) {
            .threshold-prompt {
                font-size: 1.8rem;
            }

            .content-grid,
            .worlds-grid,
            .community-grid,
            .submission-categories,
            .lore-grid {
                grid-template-columns: 1fr;
            }

            .modal-content {
                padding: 2rem;
                width: 90%;
            }

            .nav-menu {
                gap: 1rem;
            }

            .nav-menu button {
                font-size: 0.8rem;
            }
        }

        /* ===== ERA-SPECIFIC THEMING ===== */
        .era-default {
            --primary-color: #ff6cb4;
            --secondary-color: #64c8ff;
        }

        .era-era1 {
            --primary-color: #ffd700;
            --secondary-color: #ff6b35;
        }

        .era-era2 {
            --primary-color: #a8e6cf;
            --secondary-color: #56ab91;
        }
    </style>
</head>
<body>

<!-- NAVIGATION -->
<nav class="navigation" id="navigation">
    <div class="nav-logo">Kiramel Studios</div>
    <ul class="nav-menu">
        <li><button onclick="navigateTo('hub')" id="nav-hub">Viewing Room</button></li>
        <li><button onclick="navigateTo('worlds')" id="nav-worlds" class="locked">Worlds</button></li>
        <li><button onclick="navigateTo('community')" id="nav-community" class="locked">Community</button></li>
        <li><button onclick="navigateTo('writers-room')" id="nav-writers" class="locked">Writers' Room</button></li>
    </ul>
</nav>

<!-- THRESHOLD PAGE -->
<div id="threshold" class="page active">
    <div class="threshold-content">
        <h1 class="threshold-prompt">Enter the Threshold<br>Choose Your World.</h1>
        
        <div class="logo-container">
            <div class="logo">
                <div class="caramel">
                    <div class="bite"></div>
                </div>
            </div>
        </div>

        <button class="enter-button" onclick="navigateTo('trailer')">ENTER</button>
    </div>
</body>
</div>

<!-- TRAILER PAGE -->
<div id="trailer" class="page">
    <div class="container trailer-container">
        <div class="video-wrapper">
            <iframe id="trailerVideo" src="" allow="autoplay; encrypted-media" allowfullscreen></iframe>
        </div>
        <div class="trailer-info">
            <h2 class="trailer-title" id="trailerTitle">Current Era Trailer</h2>
            <p class="trailer-description" id="trailerDesc">Watch the full trailer to unlock access to the hub.</p>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="timer">
                <span id="currentTime">0:00</span> / <span id="duration">0:00</span>
            </div>
        </div>
    </div>
</div>

<!-- HUB PAGE -->
<div id="hub" class="page">
    <div class="back-nav">
        <button class="back-button" onclick="navigateTo('threshold')">‚Üê Return to Threshold</button>
    </div>
    <div class="container">
        <div class="hub-header">
            <h1 class="hub-title" id="currentWorldTitle">Welcome to the Hub</h1>
            <p class="era-info" id="currentEraInfo">Current Era</p>
        </div>

        <div class="content-grid">
            <div class="content-card">
                <h3>üéµ Music</h3>
                <p>The active EP or album. Stream, listen, and download the core release of this era.</p>
            </div>
            <div class="content-card">
                <h3>üé¨ Films</h3>
                <p>The associated short films and visual expressions that accompany the music.</p>
            </div>
            <div class="content-card">
                <h3>üìñ Notes</h3>
                <p>Contextual analysis and creative thoughts behind the work.</p>
            </div>
        </div>

        <h2 class="section-title">Explore Other Worlds</h2>
        <div class="worlds-grid" id="worldsGrid">
            <!-- Populated by JavaScript -->
        </div>
    </div>
</div>

<!-- WORLD PAGE -->
<div id="world" class="page">
    <div class="back-nav">
        <button class="back-button" onclick="navigateTo('hub')">‚Üê Back to Hub</button>
    </div>
    <div class="container">
        <div class="world-header">
            <h1 class="world-title" id="worldTitle">World Title</h1>
            <p class="world-year" id="worldYear">Year</p>
            <p class="world-description" id="worldDescription">Description</p>
        </div>

        <div class="songs-section">
            <h2 class="section-title">Songs from This Era</h2>
            <div class="song-list" id="songsList">
                <!-- Populated by JavaScript -->
            </div>
        </div>

        <div class="films-section">
            <h2 class="section-title">Films</h2>
            <div id="filmsList">
                <!-- Populated by JavaScript -->
            </div>
        </div>

        <div style="margin-top: 3rem; text-align: center;">
            <button class="btn" onclick="showLorePack()">View Lore Pack</button>
        </div>
    </div>
</div>

<!-- LORE PACK PAGE -->
<div id="lore-pack" class="page">
    <div class="back-nav">
        <button class="back-button" onclick="navigateTo('world')">‚Üê Back to World</button>
    </div>
    <div class="container">
        <div class="lore-header">
            <h1 class="lore-title" id="loreTitle">Lore Pack</h1>
            <p class="lore-subtitle">Curated archive of creative development and background materials.</p>
        </div>

        <div class="lore-grid" id="loreGrid">
            <!-- Populated by JavaScript -->
        </div>
    </div>
</div>

<!-- COMMUNITY PAGE -->
<div id="community" class="page">
    <div class="back-nav">
        <button class="back-button" onclick="navigateTo('hub')">‚Üê Back to Hub</button>
    </div>
    <div class="container">
        <div class="community-header">
            <h1 class="community-title">Community</h1>
            <p class="community-notice">
                This is a structured, moderated community. Era-specific discussions, theory analysis, and event-based threads.
                No follower counts. No algorithmic feeds. No voting. Pure participation.
            </p>
        </div>

        <div class="community-grid" id="communityThreads">
            <!-- Populated by JavaScript -->
        </div>
    </div>
</div>

<!-- WRITERS' ROOM PAGE -->
<div id="writers-room" class="page">
    <div class="back-nav">
        <button class="back-button" onclick="navigateTo('hub')">‚Üê Back to Hub</button>
    </div>
    <div class="container">
        <div class="writers-header">
            <h1 class="writers-title">Writers' Room</h1>
            <p class="submission-notice">
                A curated space for your creative contributions inspired by our work. Submit written pieces, lore theories, 
                or concept ideas. All submissions are reviewed. Highlighted work influences atmosphere and dialogue.
            </p>
        </div>

        <div class="submission-categories">
            <div class="category-card">
                <h3 class="category-title">Written Works</h3>
                <p class="category-description">
                    Short stories, poems, or creative pieces inspired by our music and world.
                </p>
                <button class="submit-button">Submit</button>
            </div>
            <div class="category-card">
                <h3 class="category-title">Lore Theories</h3>
                <p class="category-description">
                    Your interpretations, analysis, or theories about the narrative and world.
                </p>
                <button class="submit-button">Submit</button>
            </div>
            <div class="category-card">
                <h3 class="category-title">Concept Ideas</h3>
                <p class="category-description">
                    Visual, film, or narrative concepts inspired by the work.
                </p>
                <button class="submit-button">Submit</button>
            </div>
        </div>
    </div>
</div>

<!-- MODAL FOR DETAILED CONTENT -->
<div class="modal" id="modal">
    <div class="modal-content">
        <button class="modal-close" onclick="closeModal()">√ó</button>
        <h2 class="modal-title" id="modalTitle">Title</h2>
        <div class="modal-text" id="modalText">Content goes here</div>
    </div>
</div>

<script>
// ===== STATE MANAGEMENT =====
const state = {
    trailerWatched: localStorage.getItem('trailerWatched') === 'true',
    worldsExplored: JSON.parse(localStorage.getItem('worldsExplored') || '{}'),
    currentEra: 'era1',
    currentPage: 'threshold'
};

// ===== WORLDS/ERAS CONFIGURATION =====
const worlds = [
    {
        id: 'era1',
        title: 'Caramel Dreams',
        year: 2024,
        color: '#ffd700',
        description: 'The first era exploring themes of sweetness, transformation, and hidden depths.',
        trailerUrl: 'https://www.youtube.com/embed/dQw4w9WgXcQ', // Replace with actual trailer
        trailerTitle: 'Caramel Dreams - Era Trailer',
        trailerDesc: 'Immerse yourself in the first world.',
        songs: [
            { id: 1, title: 'Melting Point', duration: '4:23', artist: 'Kiramel' },
            { id: 2, title: 'Golden Ratio', duration: '3:45', artist: 'Kiramel' },
            { id: 3, title: 'Shattered Sweetness', duration: '5:02', artist: 'Kiramel' }
        ],
        films: [
            { id: 1, title: 'The Caramel Study', duration: '12:30', description: 'A visual exploration of transformation.' }
        ],
        lorePack: [
            { title: 'Original Script', type: 'Script', description: 'The original conceptual script for Caramel Dreams.' },
            { title: 'Creative Notes', type: 'Notes', description: 'Detailed notes on the creative process and inspiration.' },
            { title: 'Development Materials', type: 'Visual', description: 'Conceptual sketches and development work.' }
        ],
        communityThreads: [
            { title: 'On the Meaning of Sweetness', posts: 24 },
            { title: 'Shattered Sweetness Analysis', posts: 18 },
            { title: 'Upcoming Events & Discussions', posts: 12 }
        ]
    },
    {
        id: 'era2',
        title: 'Crystalline Future',
        year: 2025,
        color: '#a8e6cf',
        description: 'The second era, exploring clarity, precision, and forward movement.',
        songs: [
            { id: 1, title: 'Crystal Clear', duration: '3:56', artist: 'Kiramel' },
            { id: 2, title: 'Future Past', duration: '4:34', artist: 'Kiramel' }
        ],
        films: [],
        lorePack: [
            { title: 'Narrative Framework', type: 'Document', description: 'The underlying narrative structure.' }
        ],
        communityThreads: [
            { title: 'Crystal Symbolism Decoded', posts: 15 }
        ]
    }
];

// ===== UTILITY FUNCTIONS =====
function getCurrentWorld() {
    return worlds.find(w => w.id === state.currentEra);
}

function navigateTo(pageId) {
    // Check if page is locked
    if (pageId === 'worlds' && !state.trailerWatched) {
        alert('Watch the trailer first to unlock the Worlds section.');
        return;
    }
    if ((pageId === 'community' || pageId === 'writers-room') && Object.keys(state.worldsExplored).length === 0) {
        alert('Explore a world first to unlock Community and Writers\' Room.');
        return;
    }

    // Hide all pages
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    
    // Show target page
    const target = document.getElementById(pageId);
    if (target) {
        target.classList.add('active');
        state.currentPage = pageId;

        // Update navigation
        updateNavigation();

        // Handle specific page setup
        if (pageId === 'hub') setupHubPage();
        if (pageId === 'worlds') setupWorldsPage();
        if (pageId === 'trailer') setupTrailerPage();
        if (pageId === 'community') setupCommunityPage();

        // Scroll to top
        window.scrollTo(0, 0);
    }
}

function updateNavigation() {
    const nav = document.getElementById('navigation');
    if (state.trailerWatched) {
        nav.classList.add('active');
        document.body.classList.add('has-nav');
    }

    // Update nav button states
    document.getElementById('nav-worlds').classList.toggle('locked', !state.trailerWatched);
    document.getElementById('nav-community').classList.toggle('locked', Object.keys(state.worldsExplored).length === 0);
    document.getElementById('nav-writers').classList.toggle('locked', Object.keys(state.worldsExplored).length === 0);
}

// ===== THRESHOLD PAGE =====
function enterThreshold() {
    navigateTo('trailer');
}

// ===== TRAILER PAGE =====
function setupTrailerPage() {
    const current = getCurrentWorld();
    document.getElementById('trailerVideo').src = current.trailerUrl;
    document.getElementById('trailerTitle').textContent = current.trailerTitle;
    document.getElementById('trailerDesc').textContent = current.trailerDesc;

    // Simulate trailer progress tracking
    const video = document.getElementById('trailerVideo');
    setupVideoProgress('#trailerVideo');
}

function setupVideoProgress(videoSelector) {
    // For embedded YouTube, we'll simulate progress
    const progressFill = document.getElementById('progressFill');
    const currentTimeEl = document.getElementById('currentTime');
    const durationEl = document.getElementById('duration');

    let watchedDuration = 0;
    const totalDuration = 180; // 3 minutes assumed

    const interval = setInterval(() => {
        watchedDuration += 1;
        const progress = (watchedDuration / totalDuration) * 100;
        progressFill.style.width = progress + '%';
        
        const mins = Math.floor(watchedDuration / 60);
        const secs = watchedDuration % 60;
        currentTimeEl.textContent = `${mins}:${secs.toString().padStart(2, '0')}`;
        durationEl.textContent = '3:00';

        if (watchedDuration >= totalDuration) {
            clearInterval(interval);
            markTrailerAsWatched();
        }
    }, 1000);
}

function markTrailerAsWatched() {
    state.trailerWatched = true;
    localStorage.setItem('trailerWatched', 'true');
    updateNavigation();
    
    // Show unlock notification
    alert('üé¨ Trailer Complete\n\nYou now have access to the Hub and World exploration.');
    navigateTo('hub');
}

// ===== HUB PAGE =====
function setupHubPage() {
    const current = getCurrentWorld();
    document.getElementById('currentWorldTitle').textContent = current.title;
    document.getElementById('currentEraInfo').textContent = `Current Era: ${current.year}`;

    // Populate worlds grid
    const grid = document.getElementById('worldsGrid');
    grid.innerHTML = '';
    worlds.forEach(world => {
        const card = document.createElement('div');
        card.className = 'world-card';
        card.style.background = `linear-gradient(135deg, ${world.color}30 0%, ${world.color}10 100%)`;
        card.onclick = () => viewWorld(world.id);
        card.innerHTML = `
            <div class="world-card-content">
                <h3>${world.title}</h3>
                <div class="world-card-year">${world.year}</div>
            </div>
        `;
        grid.appendChild(card);
    });
}

// ===== WORLDS PAGE =====
function setupWorldsPage() {
    // This would be a dedicated page showing all worlds
    // For now, worlds are accessed from the hub
}

function viewWorld(worldId) {
    const world = worlds.find(w => w.id === worldId);
    if (!world) return;

    state.currentEra = worldId;
    state.worldsExplored[worldId] = true;
    localStorage.setItem('worldsExplored', JSON.stringify(state.worldsExplored));

    // Populate world page
    document.getElementById('worldTitle').textContent = world.title;
    document.getElementById('worldYear').textContent = world.year;
    document.getElementById('worldDescription').textContent = world.description;

    // Songs list
    const songsList = document.getElementById('songsList');
    songsList.innerHTML = '';
    world.songs.forEach(song => {
        const item = document.createElement('div');
        item.className = 'song-item';
        item.onclick = () => playSong(song);
        item.innerHTML = `
            <div class="song-info">
                <h4>${song.title}</h4>
                <div class="song-duration">${song.duration}</div>
            </div>
            <span class="play-icon">‚ñ∂</span>
        `;
        songsList.appendChild(item);
    });

    // Films list
    const filmsList = document.getElementById('filmsList');
    filmsList.innerHTML = '';
    if (world.films.length > 0) {
        world.films.forEach(film => {
            const item = document.createElement('div');
            item.className = 'song-item';
            item.onclick = () => showModal(film.title, `${film.title}\n\n${film.description}\n\nDuration: ${film.duration}`);
            item.innerHTML = `
                <div class="song-info">
                    <h4>üé¨ ${film.title}</h4>
                    <div class="song-duration">${film.duration}</div>
                </div>
                <span class="play-icon">‚ñ∂</span>
            `;
            filmsList.appendChild(item);
        });
    } else {
        filmsList.innerHTML = '<p style="color: #999;">No films available yet.</p>';
    }

    updateNavigation();
    navigateTo('world');
}

function playSong(song) {
    showModal(`Now Playing: ${song.title}`, `
        <p><strong>${song.title}</strong></p>
        <p style="color: #999; margin-top: 1rem;">${song.duration}</p>
        <p style="margin-top: 2rem;">Audio player would load here in a production environment.</p>
    `);
}

// ===== LORE PACK PAGE =====
function showLorePack() {
    const world = getCurrentWorld();
    
    document.getElementById('loreTitle').textContent = `${world.title} - Lore Pack`;
    
    const grid = document.getElementById('loreGrid');
    grid.innerHTML = '';
    
    world.lorePack.forEach(item => {
        const card = document.createElement('div');
        card.className = 'lore-card';
        card.onclick = () => showModal(item.title, `
            <strong>${item.type}</strong>
            <p style="color: #999; margin-top: 0.5rem;">${item.description}</p>
            <p style="margin-top: 2rem; color: #666; font-size: 0.9rem;">
                This is a curated archive entry. Content is intentionally finite and complete.
            </p>
        `);
        card.innerHTML = `
            <h3>${item.title}</h3>
            <p><small>${item.type}</small></p>
            <p>${item.description}</p>
        `;
        grid.appendChild(card);
    });

    navigateTo('lore-pack');
}

// ===== COMMUNITY PAGE =====
function setupCommunityPage() {
    const world = getCurrentWorld();
    
    const container = document.getElementById('communityThreads');
    container.innerHTML = '';
    
    world.communityThreads.forEach(thread => {
        const card = document.createElement('div');
        card.className = 'community-thread';
        card.onclick = () => showModal(thread.title, `
            <strong>${thread.title}</strong>
            <p style="color: #999; margin-top: 1rem;">${thread.posts} posts</p>
            <p style="margin-top: 2rem; color: #666; font-size: 0.9rem;">
                This is a structured discussion space. No voting, no algorithmic ranking. Pure participation.
            </p>
        `);
        card.innerHTML = `
            <h3 class="thread-title">${thread.title}</h3>
            <p class="thread-meta">${thread.posts} posts in this era</p>
        `;
        container.appendChild(card);
    });
}

// ===== MODAL =====
function showModal(title, text) {
    document.getElementById('modalTitle').textContent = title;
    document.getElementById('modalText').innerHTML = text.replace(/\n/g, '<br>');
    document.getElementById('modal').classList.add('active');
}

function closeModal() {
    document.getElementById('modal').classList.remove('active');
}

// Close modal on outside click
document.addEventListener('DOMContentLoaded', function() {
    document.getElementById('modal').addEventListener('click', function(e) {
        if (e.target === this) closeModal();
    });

    // Initialize on load
    updateNavigation();
});
</script>

</html>
